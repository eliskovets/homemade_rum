BOOMR_start=(new Date).getTime();
function BOOMR_check_doc_domain(domain){var test;if(!window)return;if(!domain){if(window.parent===window||!document.getElementById("boomr-if-as"))return;if(window.BOOMR&&BOOMR.boomerang_frame&&BOOMR.window)try{if(BOOMR.boomerang_frame.document.domain!==BOOMR.window.document.domain)BOOMR.boomerang_frame.document.domain=BOOMR.window.document.domain}catch(err){if(!BOOMR.isCrossOriginError(err))BOOMR.addError(err,"BOOMR_check_doc_domain.domainFix")}domain=document.domain}if(domain.indexOf(".")===-1)return;
try{test=window.parent.document;return}catch(err$0){document.domain=domain}try{test=window.parent.document;return}catch(err$1){domain=domain.replace(/^[\w\-]+\./,"")}BOOMR_check_doc_domain(domain)}BOOMR_check_doc_domain();
(function(w){var impl,boomr,d,myurl,createCustomEvent,dispatchEvent,visibilityState,visibilityChange,orig_w=w;if(w.parent!==w&&document.getElementById("boomr-if-as")&&document.getElementById("boomr-if-as").nodeName.toLowerCase()==="script"){w=w.parent;myurl=document.getElementById("boomr-if-as").src}d=w.document;if(!w.BOOMR)w.BOOMR={};BOOMR=w.BOOMR;if(BOOMR.version)return;BOOMR.version="%boomerang_version%";BOOMR.window=w;BOOMR.boomerang_frame=orig_w;if(!BOOMR.plugins)BOOMR.plugins={};(function(){try{if(new w.CustomEvent("CustomEvent")!==
undefined)createCustomEvent=function(e_name,params){return new w.CustomEvent(e_name,params)}}catch(ignore){}try{if(!createCustomEvent&&d.createEvent&&d.createEvent("CustomEvent"))createCustomEvent=function(e_name,params){var evt=d.createEvent("CustomEvent");params=params||{cancelable:false,bubbles:false};evt.initCustomEvent(e_name,params.bubbles,params.cancelable,params.detail);return evt}}catch(ignore$2){}if(!createCustomEvent&&d.createEventObject)createCustomEvent=function(e_name,params){var evt=
d.createEventObject();evt.type=evt.propertyName=e_name;evt.detail=params.detail;return evt};if(!createCustomEvent)createCustomEvent=function(){return undefined}})();dispatchEvent=function(e_name,e_data,async){var ev=createCustomEvent(e_name,{"detail":e_data});if(!ev)return;function dispatch(){try{if(d.dispatchEvent)d.dispatchEvent(ev);else if(d.fireEvent)d.fireEvent("onpropertychange",ev)}catch(e){BOOMR.debug("Error when dispatching "+e_name)}}if(async)BOOMR.setImmediate(dispatch);else dispatch()};
if(typeof document.hidden!=="undefined"){visibilityState="visibilityState";visibilityChange="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){visibilityState="mozVisibilityState";visibilityChange="mozvisibilitychange"}else if(typeof document.msHidden!=="undefined"){visibilityState="msVisibilityState";visibilityChange="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){visibilityState="webkitVisibilityState";visibilityChange="webkitvisibilitychange"}impl={beacon_url:"",
beacon_type:"AUTO",beacon_auth_key:"Authorization",beacon_auth_token:undefined,site_domain:w.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",autorun:true,hasSentPageLoadBeacon:false,r:undefined,r2:undefined,events:{"page_ready":[],"page_unload":[],"before_unload":[],"dom_loaded":[],"visibility_changed":[],"prerender_to_visible":[],"before_beacon":[],"onbeacon":[],"page_load_beacon":[],"xhr_load":[],"click":[],"form_submit":[],"onconfig":[],"xhr_init":[],"spa_init":[],
"spa_navigation":[],"xhr_send":[]},public_events:{"before_beacon":"onBeforeBoomerangBeacon","onbeacon":"onBoomerangBeacon","onboomerangloaded":"onBoomerangLoaded"},listenerCallbacks:{},vars:{},varPriority:{"-1":{},1:{}},errors:{},disabled_plugins:{},xb_handler:function(type){return function(ev){var target;if(!ev)ev=w.event;if(ev.target)target=ev.target;else if(ev.srcElement)target=ev.srcElement;if(target.nodeType===3)target=target.parentNode;if(target&&target.nodeName.toUpperCase()==="OBJECT"&&target.type===
"application/x-shockwave-flash")return;impl.fireEvent(type,target)}},clearEvents:function(){var eventName;for(eventName in this.events)if(this.events.hasOwnProperty(eventName))this.events[eventName]=[]},clearListeners:function(){var type,i;for(type in impl.listenerCallbacks)if(impl.listenerCallbacks.hasOwnProperty(type))while(impl.listenerCallbacks[type].length)BOOMR.utils.removeListener(impl.listenerCallbacks[type][0].el,type,impl.listenerCallbacks[type][0].fn);impl.listenerCallbacks={}},fireEvent:function(e_name,
data){var i,handler,handlers,handlersLen;e_name=e_name.toLowerCase();if(!this.events.hasOwnProperty(e_name))return;if(this.public_events.hasOwnProperty(e_name))dispatchEvent(this.public_events[e_name],data);handlers=this.events[e_name];if(e_name!=="before_beacon"&&e_name!=="onbeacon")BOOMR.real_sendBeacon();handlersLen=handlers.length;for(i=0;i<handlersLen;i++)try{handler=handlers[i];handler.fn.call(handler.scope,data,handler.cb_data)}catch(err){BOOMR.addError(err,"fireEvent."+e_name+"<"+i+">")}for(i=
0;i<handlersLen;i++)if(handlers[i].once){handlers.splice(i,1);handlersLen--;i--}return},spaNavigation:function(){impl.onloadfired=true}};boomr={t_start:BOOMR_start,url:myurl,constants:{BEACON_TYPE_SPAS:["spa","spa_hard"],MAX_GET_LENGTH:2E3},utils:{objectToString:function(o,separator,nest_level){var value=[],k;if(!o||typeof o!=="object")return o;if(separator===undefined)separator="\n\t";if(!nest_level)nest_level=0;if(Object.prototype.toString.call(o)==="[object Array]"){for(k=0;k<o.length;k++)if(nest_level>
0&&o[k]!==null&&typeof o[k]==="object")value.push(this.objectToString(o[k],separator+(separator==="\n\t"?"\t":""),nest_level-1));else if(separator==="&")value.push(encodeURIComponent(o[k]));else value.push(o[k]);separator=","}else for(k in o)if(Object.prototype.hasOwnProperty.call(o,k))if(nest_level>0&&o[k]!==null&&typeof o[k]==="object")value.push(encodeURIComponent(k)+"="+this.objectToString(o[k],separator+(separator==="\n\t"?"\t":""),nest_level-1));else if(separator==="&")value.push(encodeURIComponent(k)+
"="+encodeURIComponent(o[k]));else value.push(k+"="+o[k]);return value.join(separator)},getCookie:function(name){if(!name)return null;name=" "+name+"=";var i,cookies;cookies=" "+d.cookie+";";if((i=cookies.indexOf(name))>=0){i+=name.length;cookies=cookies.substring(i,cookies.indexOf(";",i)).replace(/^"/,"").replace(/"$/,"");return cookies}},setCookie:function(name,subcookies,max_age){var value,nameval,savedval,c,exp;if(!name||!impl.site_domain){BOOMR.debug("No cookie name or site domain: "+name+"/"+
impl.site_domain);return false}value=this.objectToString(subcookies,"&");nameval=name+'="'+value+'"';c=[nameval,"path=/","domain="+impl.site_domain];if(max_age){exp=new Date;exp.setTime(exp.getTime()+max_age*1E3);exp=exp.toGMTString();c.push("expires="+exp)}if(nameval.length<500){d.cookie=c.join("; ");savedval=this.getCookie(name);if(value===savedval)return true;BOOMR.warn("Saved cookie value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else BOOMR.warn("Cookie too long: "+nameval.length+
" "+nameval);return false},getSubCookies:function(cookie){var cookies_a,i,l,kv,gotcookies=false,cookies={};if(!cookie)return null;if(typeof cookie!=="string"){BOOMR.debug("TypeError: cookie is not a string: "+typeof cookie);return null}cookies_a=cookie.split("&");for(i=0,l=cookies_a.length;i<l;i++){kv=cookies_a[i].split("=");if(kv[0]){kv.push("");cookies[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]);gotcookies=true}}return gotcookies?cookies:null},removeCookie:function(name){return this.setCookie(name,
{},-86400)},cleanupURL:function(url,urlLimit){if(!url||Object.prototype.toString.call(url)==="[object Array]")return"";if(impl.strip_query_string)url=url.replace(/\?.*/,"?qs-redacted");if(typeof urlLimit!=="undefined"&&url&&url.length>urlLimit){var qsStart=url.indexOf("?");if(qsStart!==-1&&qsStart<urlLimit)url=url.substr(0,qsStart)+"?...";else url=url.substr(0,urlLimit-3)+"..."}return url},hashQueryString:function(url,stripHash){if(!url)return url;if(!url.match){BOOMR.addError("TypeError: Not a string",
"hashQueryString",typeof url);return""}if(url.match(/^\/\//))url=location.protocol+url;if(!url.match(/^(https?|file):/)){BOOMR.error("Passed in URL is invalid: "+url);return""}if(stripHash)url=url.replace(/#.*/,"");if(!BOOMR.utils.MD5)return url;return url.replace(/\?([^#]*)/,function(m0,m1){return"?"+(m1.length>10?BOOMR.utils.MD5(m1):m1)})},pluginConfig:function(o,config,plugin_name,properties){var i,props=0;if(!config||!config[plugin_name])return false;for(i=0;i<properties.length;i++)if(config[plugin_name][properties[i]]!==
undefined){o[properties[i]]=config[plugin_name][properties[i]];props++}return props>0},arrayFilter:function(array,predicate){var result=[];if(typeof array.filter==="function")result=array.filter(predicate);else{var index=-1,length=array.length,value;while(++index<length){value=array[index];if(predicate(value,index,array))result[result.length]=value}}return result},addObserver:function(el,config,timeout,callback,callback_data,callback_ctx){var o={observer:null,timer:null};if(!BOOMR.window||!BOOMR.window.MutationObserver||
!callback||!el)return null;function done(mutations){var run_again=false;if(o.timer){clearTimeout(o.timer);o.timer=null}if(callback){run_again=callback.call(callback_ctx,mutations,callback_data);if(!run_again)callback=null}if(!run_again&&o.observer){o.observer.disconnect();o.observer=null}if(typeof run_again==="number"&&run_again>0)o.timer=setTimeout(done,run_again)}o.observer=new BOOMR.window.MutationObserver(done);if(timeout)o.timer=setTimeout(done,o.timeout);o.observer.observe(el,config);return o},
addListener:function(el,type,fn){if(el.addEventListener)el.addEventListener(type,fn,false);else if(el.attachEvent)el.attachEvent("on"+type,fn);impl.listenerCallbacks[type]=impl.listenerCallbacks[type]||[];impl.listenerCallbacks[type].push({el:el,fn:fn})},removeListener:function(el,type,fn){var i;if(el.removeEventListener)el.removeEventListener(type,fn,false);else if(el.detachEvent)el.detachEvent("on"+type,fn);if(impl.listenerCallbacks.hasOwnProperty(type))for(var i=0;i<impl.listenerCallbacks[type].length;i++)if(fn===
impl.listenerCallbacks[type][i].fn&&el===impl.listenerCallbacks[type][i].el){impl.listenerCallbacks[type].splice(i,1);return}},pushVars:function(form,vars,prefix){var k,i,l=0,input;for(k in vars)if(vars.hasOwnProperty(k))if(Object.prototype.toString.call(vars[k])==="[object Array]")for(i=0;i<vars[k].length;++i)l+=BOOMR.utils.pushVars(form,vars[k][i],k+"["+i+"]");else{input=document.createElement("input");input.type="hidden";input.name=prefix?prefix+"["+k+"]":k;input.value=vars[k]===undefined||vars[k]===
null?"":vars[k];form.appendChild(input);l+=encodeURIComponent(input.name).length+encodeURIComponent(input.value).length+2}return l},isArray:function(ary){return Object.prototype.toString.call(ary)==="[object Array]"},inArray:function(val,ary){var i;if(typeof val==="undefined"||typeof ary==="undefined"||!ary.length)return false;for(i=0;i<ary.length;i++)if(ary[i]===val)return true;return false},getQueryParamValue:function(param,url){var l,params,i,kv;if(!param)return null;if(typeof url==="string"){l=
BOOMR.window.document.createElement("a");l.href=url}else if(typeof url==="object"&&typeof url.search==="string")l=url;else l=BOOMR.window.location;params=l.search.slice(1).split(/&/);for(i=0;i<params.length;i++)if(params[i]){kv=params[i].split("=");if(kv.length&&kv[0]===param)return decodeURIComponent(kv[1].replace(/\+/g," "))}return null},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==="x"?r:r&3|8;return v.toString(16)})},
generateId:function(chars){return"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".substr(0,chars||40).replace(/x/g,function(c){var c=(Math.random()||.01).toString(36);if(c==="0")return"0";else return c.substr(2,1)})}},init:function(config){var i,k,properties=["beacon_url","beacon_type","beacon_auth_key","beacon_auth_token","site_domain","user_ip","strip_query_string","secondary_beacons","autorun","site_domain"];BOOMR_check_doc_domain();if(!config)config={};if(!this.pageId)this.pageId=BOOMR.utils.generateId(8);
if(config.primary&&impl.handlers_attached)return this;if(config.log!==undefined)this.log=config.log;if(!this.log)this.log=function(){};if(typeof config.autorun!=="undefined")impl.autorun=config.autorun;for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(config[k]&&config[k].hasOwnProperty("enabled")&&config[k].enabled===false){impl.disabled_plugins[k]=1;if(typeof this.plugins[k].disable==="function")this.plugins[k].disable();continue}if(impl.disabled_plugins[k]){if(!config[k]||!config[k].hasOwnProperty("enabled")||
config[k].enabled!==true)continue;if(typeof this.plugins[k].enable==="function")this.plugins[k].enable();delete impl.disabled_plugins[k]}if(typeof this.plugins[k].init==="function")try{this.plugins[k].init(config)}catch(err){BOOMR.addError(err,k+".init")}}for(i=0;i<properties.length;i++)if(config[properties[i]]!==undefined)impl[properties[i]]=config[properties[i]];if(impl.handlers_attached)return this;if(!impl.onloadfired&&(config.autorun===undefined||config.autorun!==false))if(d.readyState&&d.readyState===
"complete"){BOOMR.loadedLate=true;this.setImmediate(BOOMR.page_ready_autorun,null,null,BOOMR)}else if(w.onpagehide||w.onpagehide===null)BOOMR.utils.addListener(w,"pageshow",BOOMR.page_ready_autorun);else BOOMR.utils.addListener(w,"load",BOOMR.page_ready_autorun);BOOMR.utils.addListener(w,"DOMContentLoaded",function(){impl.fireEvent("dom_loaded")});BOOMR.fireEvent("onconfig",config);BOOMR.subscribe("onconfig",function(beaconConfig){if(beaconConfig.beacon_url)impl.beacon_url=beaconConfig.beacon_url});
BOOMR.subscribe("spa_navigation",impl.spaNavigation,null,impl);(function(){var forms,iterator;if(visibilityChange!==undefined){BOOMR.utils.addListener(d,visibilityChange,function(){impl.fireEvent("visibility_changed")});impl.lastVisibilityState=BOOMR.visibilityState();BOOMR.subscribe("visibility_changed",function(){var visState=BOOMR.visibilityState();BOOMR.lastVisibilityEvent[visState]=BOOMR.now();BOOMR.debug("Visibility changed from "+impl.lastVisibilityState+" to "+visState);if(impl.lastVisibilityState===
"prerender"&&visState!=="prerender"){BOOMR.addVar("vis.pre","1");impl.fireEvent("prerender_to_visible")}impl.lastVisibilityState=visState})}BOOMR.utils.addListener(d,"mouseup",impl.xb_handler("click"));forms=d.getElementsByTagName("form");for(iterator=0;iterator<forms.length;iterator++)BOOMR.utils.addListener(forms[iterator],"submit",impl.xb_handler("form_submit"));if(!w.onpagehide&&w.onpagehide!==null)BOOMR.utils.addListener(w,"unload",function(){BOOMR.window=w=null})})();impl.handlers_attached=
true;return this},attach_page_ready:function(cb){if(d.readyState&&d.readyState==="complete")this.setImmediate(cb,null,null,BOOMR);else if(w.onpagehide||w.onpagehide===null)BOOMR.utils.addListener(w,"pageshow",cb);else BOOMR.utils.addListener(w,"load",cb)},page_ready_autorun:function(ev){if(impl.autorun)BOOMR.page_ready(ev)},page_ready:function(ev){if(!ev)ev=w.event;if(!ev)ev={name:"load"};if(impl.onloadfired)return this;impl.fireEvent("page_ready",ev);impl.onloadfired=true;return this},onloadFired:function(){return impl.onloadfired},
setImmediate:function(fn,data,cb_data,cb_scope){var cb,cstack;if(typeof Error!=="undefined"){cstack=new Error;cstack=cstack.stack?cstack.stack.replace(/^Error/,"Called"):undefined}cb=function(){fn.call(cb_scope||null,data,cb_data||{},cstack);cb=null};if(w.requestIdleCallback)w.requestIdleCallback(cb);else if(w.setImmediate)w.setImmediate(cb);else setTimeout(cb,10)},now:function(){return Date.now||function(){return(new Date).getTime()}}(),getPerformance:function(){try{if(BOOMR.window){if("performance"in
BOOMR.window&&BOOMR.window.performance)return BOOMR.window.performance;return BOOMR.window.msPerformance||BOOMR.window.webkitPerformance||BOOMR.window.mozPerformance}}catch(ignore){}},visibilityState:visibilityState===undefined?function(){return"visible"}:function(){return d[visibilityState]},lastVisibilityEvent:{},registerEvent:function(e_name){if(impl.events.hasOwnProperty(e_name))return this;impl.events[e_name]=[];return this},disable:function(){impl.clearEvents();impl.clearListeners()},fireEvent:function(e_name,
data){return impl.fireEvent(e_name,data)},subscribe:function(e_name,fn,cb_data,cb_scope,once){var i,handler,ev;e_name=e_name.toLowerCase();if(!impl.events.hasOwnProperty(e_name))impl.events[e_name]=[];ev=impl.events[e_name];for(i=0;i<ev.length;i++){handler=ev[i];if(handler&&handler.fn===fn&&handler.cb_data===cb_data&&handler.scope===cb_scope)return this}ev.push({fn:fn,cb_data:cb_data||{},scope:cb_scope||null,once:once||false});if(e_name==="page_ready"&&impl.onloadfired&&impl.autorun)this.setImmediate(fn,
null,cb_data,cb_scope);if(e_name==="page_unload"||e_name==="before_unload")(function(){var unload_handler,evt_idx=ev.length;unload_handler=function(evt){if(fn)fn.call(cb_scope,evt||w.event,cb_data);if(e_name==="page_unload"&&evt_idx===impl.events[e_name].length)BOOMR.real_sendBeacon()};if(e_name==="page_unload")if(w.onpagehide||w.onpagehide===null)BOOMR.utils.addListener(w,"pagehide",unload_handler);else BOOMR.utils.addListener(w,"unload",unload_handler);BOOMR.utils.addListener(w,"beforeunload",unload_handler)})();
return this},addError:function BOOMR_addError(err,src,extra){var str,E=BOOMR.plugins.Errors;if(E&&E.is_supported()){if(typeof err==="string")E.send({message:err,extra:extra,functionName:src,noStack:true},E.VIA_APP,E.SOURCE_BOOMERANG);else{if(typeof src==="string")err.functionName=src;if(typeof extra!=="undefined")err.extra=extra;E.send(err,E.VIA_APP,E.SOURCE_BOOMERANG)}return}if(typeof err!=="string"){str=String(err);if(str.match(/^\[object/))str=err.name+": "+(err.description||err.message).replace(/\r\n$/,
"");err=str}if(src!==undefined)err="["+src+":"+BOOMR.now()+"] "+err;if(extra)err+=":: "+extra;if(impl.errors[err])impl.errors[err]++;else impl.errors[err]=1},isCrossOriginError:function(err){return err.name==="SecurityError"||err.name==="TypeError"&&err.message==="Permission denied"||err.name==="Error"&&err.message&&err.message.match(/^(Permission|Access is) denied/)},addVar:function(name,value){if(typeof name==="string")impl.vars[name]=value;else if(typeof name==="object"){var o=name,k;for(k in o)if(o.hasOwnProperty(k))impl.vars[k]=
o[k]}return this},removeVar:function(arg0){var i,params;if(!arguments.length)return this;if(arguments.length===1&&Object.prototype.toString.apply(arg0)==="[object Array]")params=arg0;else params=arguments;for(i=0;i<params.length;i++)if(impl.vars.hasOwnProperty(params[i]))delete impl.vars[params[i]];return this},hasVar:function(name){return impl.vars.hasOwnProperty(name)},setVarPriority:function(name,pri){if(typeof pri!=="number"||Math.abs(pri)!==1)return this;impl.varPriority[pri][name]=1;return this},
setReferrer:function(r,r2){impl.r=r;if(r2&&r!==r2)impl.r2=r2;else impl.r2=undefined},requestStart:function(name){var t_start=BOOMR.now();BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);return{loaded:function(data){BOOMR.responseEnd(name,t_start,data)}}},readyToSend:function(){var plugin;for(plugin in this.plugins)if(this.plugins.hasOwnProperty(plugin)){if(impl.disabled_plugins[plugin])continue;if(typeof this.plugins[plugin].readyToSend==="function"&&this.plugins[plugin].readyToSend()===false){BOOMR.debug("Plugin "+
plugin+" is not ready to send");return false}}return true},responseEnd:function(name,t_start,data,t_end){t_start=typeof t_start==="number"?t_start:BOOMR.now();t_end=typeof t_end==="number"?t_end:BOOMR.now();if(!BOOMR.readyToSend()){BOOMR.debug("Attempted to call responseEnd before all plugins were Ready to Send, trying again...");setTimeout(function(){BOOMR.responseEnd(name,t_start,data,t_end)},1E3);return}if(!BOOMR.hasSentPageLoadBeacon()&&!BOOMR.utils.inArray(name.initiator,BOOMR.constants.BEACON_TYPE_SPAS)){BOOMR.subscribe("page_load_beacon",
function(){BOOMR.responseEnd(name,t_start,data,t_end)},null,BOOMR,true);return}if(typeof name==="object"){if(!name.url){BOOMR.debug("BOOMR.responseEnd: First argument must have a url property if it's an object");return}impl.fireEvent("xhr_load",name)}else{BOOMR.real_sendBeacon();BOOMR.addVar("xhr.pg",name);BOOMR.plugins.RT.startTimer("xhr_"+name,t_start);impl.fireEvent("xhr_load",{name:"xhr_"+name,data:data,timing:{loadEventEnd:t_end}})}},uninstrumentXHR:function(){},instrumentXHR:function(){},sendBeacon:function(beacon_url_override){if(beacon_url_override)impl.beacon_url_override=
beacon_url_override;if(!impl.beaconQueued){impl.beaconQueued=true;BOOMR.setImmediate(BOOMR.real_sendBeacon,null,null,BOOMR)}return true},real_sendBeacon:function(){var k,form,url,img,errors=[],params=[],paramsJoined,useImg=1,varsSent={},varsToSend={},urlFirst=[],urlLast=[],xhr;if(!impl.beaconQueued)return false;impl.beaconQueued=false;BOOMR.debug("Checking if we can send beacon");for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(impl.disabled_plugins[k])continue;if(!this.plugins[k].is_complete()){BOOMR.debug("Plugin "+
k+" is not complete, deferring beacon send");return false}}if(!window||!window.Image||!window.navigator||!BOOMR.window){BOOMR.debug("DOM not fully available, not sending a beacon");return false}var isSPA=BOOMR.utils.inArray(impl.vars["http.initiator"],BOOMR.constants.BEACON_TYPE_SPAS);var isPageLoad=typeof impl.vars["http.initiator"]==="undefined"||isSPA;var pgu=isSPA?d.URL:d.URL.replace(/#.*/,"");impl.vars.pgu=BOOMR.utils.cleanupURL(pgu);if(!impl.vars.u||isSPA)impl.vars.u=impl.vars.pgu;if(impl.vars.pgu===
impl.vars.u)delete impl.vars.pgu;if(impl.r)impl.vars.r=BOOMR.utils.cleanupURL(impl.r);else delete impl.vars.r;if(impl.r2)impl.vars.r2=BOOMR.utils.cleanupURL(impl.r2);else delete impl.vars.r2;impl.vars.v=BOOMR.version;if(BOOMR.visibilityState()){impl.vars["vis.st"]=BOOMR.visibilityState();if(BOOMR.lastVisibilityEvent.visible)impl.vars["vis.lv"]=BOOMR.now()-BOOMR.lastVisibilityEvent.visible;if(BOOMR.lastVisibilityEvent.hidden)impl.vars["vis.lh"]=BOOMR.now()-BOOMR.lastVisibilityEvent.hidden}impl.vars["ua.plt"]=
navigator.platform;impl.vars["ua.vnd"]=navigator.vendor;if(this.pageId)impl.vars.pid=this.pageId;if(w!==window)impl.vars["if"]="";for(k in impl.errors)if(impl.errors.hasOwnProperty(k))errors.push(k+(impl.errors[k]>1?" (*"+impl.errors[k]+")":""));if(errors.length>0)impl.vars.errors=errors.join("\n");impl.errors={};impl.fireEvent("before_beacon",impl.vars);impl.beacon_url=impl.beacon_url_override||impl.beacon_url;BOOMR.debug("Ready to send beacon: "+BOOMR.utils.objectToString(impl.vars));if(!impl.beacon_url){BOOMR.debug("No beacon URL, so skipping.");
return true}for(k in impl.vars)if(impl.vars.hasOwnProperty(k)){varsSent[k]=impl.vars[k];varsToSend[k]=impl.vars[k]}urlFirst=this.getVarsOfPriority(varsToSend,-1);urlLast=this.getVarsOfPriority(varsToSend,1);params=urlFirst.concat(this.getVarsOfPriority(varsToSend,0),urlLast);paramsJoined=params.join("&");url=impl.beacon_url+(impl.beacon_url.indexOf("?")>-1?"&":"?")+paramsJoined;if(impl.beacon_type==="POST"||url.length>BOOMR.constants.MAX_GET_LENGTH)useImg=false;BOOMR.removeVar("qt");impl.fireEvent("onbeacon",
varsSent);if(!impl.hasSentPageLoadBeacon&&isPageLoad){impl.hasSentPageLoadBeacon=true;BOOMR.setImmediate(function(){impl.fireEvent("page_load_beacon",varsSent)})}if(params.length===0)return this;if(!BOOMR.orig_XMLHttpRequest&&(!BOOMR.window||!BOOMR.window.XMLHttpRequest))useImg=true;if(useImg){try{img=new Image}catch(e){BOOMR.debug("Image is not a constructor, not sending a beacon");return false}img.src=url;if(impl.secondary_beacons)for(k=0;k<impl.secondary_beacons.length;k++){url=impl.secondary_beacons[k]+
"?"+paramsJoined;img=new Image;img.src=url}}else{xhr=new (BOOMR.window.orig_XMLHttpRequest||BOOMR.orig_XMLHttpRequest||BOOMR.window.XMLHttpRequest);try{this.sendXhrPostBeacon(xhr,paramsJoined)}catch(e$3){xhr=new BOOMR.boomerang_frame.XMLHttpRequest;this.sendXhrPostBeacon(xhr,paramsJoined)}}return true},hasSentPageLoadBeacon:function(){return impl.hasSentPageLoadBeacon},sendXhrPostBeacon:function(xhr,paramsJoined){xhr.open("POST",impl.beacon_url);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
if(typeof impl.beacon_auth_token!=="undefined"){if(typeof impl.beacon_auth_key==="undefined")impl.beacon_auth_key="Authorization";xhr.setRequestHeader(impl.beacon_auth_key,impl.beacon_auth_token)}xhr.send(paramsJoined)},getVarsOfPriority:function(vars,pri){var name,url=[];if(pri!==0)for(name in impl.varPriority[pri]){if(impl.varPriority[pri].hasOwnProperty(name))if(vars.hasOwnProperty(name)){url.push(this.getUriEncodedVar(name,vars[name]));delete vars[name]}}else for(name in vars)if(vars.hasOwnProperty(name))url.push(this.getUriEncodedVar(name,
vars[name]));return url},getUriEncodedVar:function(name,value){var result=encodeURIComponent(name)+"="+(value===undefined||value===null?"":encodeURIComponent(value));return result},getResourceTiming:function(url,sort){var entries;try{if(BOOMR.getPerformance()&&typeof BOOMR.getPerformance().getEntriesByName==="function"){entries=BOOMR.getPerformance().getEntriesByName(url);if(entries&&entries.length){if(typeof sort==="function")entries.sort(sort);return entries[entries.length-1]}}}catch(ignore){}}};
delete BOOMR_start;if(typeof BOOMR_lstart==="number"){boomr.t_lstart=BOOMR_lstart;delete BOOMR_lstart}else if(typeof BOOMR.window.BOOMR_lstart==="number")boomr.t_lstart=BOOMR.window.BOOMR_lstart;if(typeof BOOMR.window.BOOMR_onload==="number")boomr.t_onload=BOOMR.window.BOOMR_onload;(function(){var make_logger;if(typeof console==="object"&&console.log!==undefined)boomr.log=function(m,l,s){console.log(s+": ["+l+"] "+m)};make_logger=function(l){return function(m,s){this.log(m,l,"boomerang"+(s?"."+s:
""));return this}};boomr.debug=make_logger("debug");boomr.info=make_logger("info");boomr.warn=make_logger("warn");boomr.error=make_logger("error")})();try{var p=boomr.getPerformance();if(p&&typeof p.now==="function"&&/\[native code\]/.test(String(p.now))&&p.timing&&p.timing.navigationStart)boomr.now=function(){return Math.round(p.now()+p.timing.navigationStart)}}catch(ignore){}(function(){var ident;for(ident in boomr)if(boomr.hasOwnProperty(ident))BOOMR[ident]=boomr[ident];if(!BOOMR.xhr_excludes)BOOMR.xhr_excludes=
{}})();dispatchEvent("onBoomerangLoaded",{"BOOMR":BOOMR},true)})(window);
(function(){BOOMR=BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(BOOMR.plugins.NavigationTiming)return;var impl={complete:false,sendBeacon:function(){this.complete=true;BOOMR.sendBeacon()},xhr_done:function(edata){var p;if(edata&&edata.initiator==="spa_hard"){impl.done(edata);return}else if(edata&&edata.initiator==="spa"){impl.sendBeacon();return}var w=BOOMR.window,res,data={},k;if(!edata)return;if(edata.data)edata=edata.data;p=BOOMR.getPerformance();if(p&&edata.restiming){data={nt_red_st:edata.restiming.redirectStart,
nt_red_end:edata.restiming.redirectEnd,nt_fet_st:edata.restiming.fetchStart,nt_dns_st:edata.restiming.domainLookupStart,nt_dns_end:edata.restiming.domainLookupEnd,nt_con_st:edata.restiming.connectStart,nt_con_end:edata.restiming.connectEnd,nt_req_st:edata.restiming.requestStart,nt_res_st:edata.restiming.responseStart,nt_res_end:edata.restiming.responseEnd};if(edata.restiming.secureConnectionStart)data.nt_ssl_st=edata.restiming.secureConnectionStart;for(k in data)if(data.hasOwnProperty(k)&&data[k]){data[k]+=
p.timing.navigationStart;data[k]=Math.floor(data[k])}}if(edata.timing){res=edata.timing;if(!data.nt_req_st)data.nt_req_st=res.requestStart;if(!data.nt_res_st)data.nt_res_st=res.responseStart;if(!data.nt_res_end)data.nt_res_end=res.responseEnd;data.nt_domint=res.domInteractive;data.nt_domcomp=res.domComplete;data.nt_load_st=res.loadEventEnd;data.nt_load_end=res.loadEventEnd}for(k in data)if(data.hasOwnProperty(k)&&!data[k])delete data[k];BOOMR.addVar(data);try{impl.addedVars.push.apply(impl.addedVars,
Object.keys(data))}catch(ignore){}impl.sendBeacon()},done:function(){var w=BOOMR.window,p,pn,pt,data;if(this.complete)return this;impl.addedVars=[];p=BOOMR.getPerformance();if(p&&p.timing&&p.navigation){BOOMR.info("This user agent supports NavigationTiming.","nt");pn=p.navigation;pt=p.timing;data={nt_red_cnt:pn.redirectCount,nt_nav_type:pn.type,nt_nav_st:pt.navigationStart,nt_red_st:pt.redirectStart,nt_red_end:pt.redirectEnd,nt_fet_st:pt.fetchStart,nt_dns_st:pt.domainLookupStart,nt_dns_end:pt.domainLookupEnd,
nt_con_st:pt.connectStart,nt_con_end:pt.connectEnd,nt_req_st:pt.requestStart,nt_res_st:pt.responseStart,nt_res_end:pt.responseEnd,nt_domloading:pt.domLoading,nt_domint:pt.domInteractive,nt_domcontloaded_st:pt.domContentLoadedEventStart,nt_domcontloaded_end:pt.domContentLoadedEventEnd,nt_domcomp:pt.domComplete,nt_load_st:pt.loadEventStart,nt_load_end:pt.loadEventEnd,nt_unload_st:pt.unloadEventStart,nt_unload_end:pt.unloadEventEnd};if(pt.secureConnectionStart)data.nt_ssl_st=pt.secureConnectionStart;
if(pt.msFirstPaint)data.nt_first_paint=pt.msFirstPaint;BOOMR.addVar(data);if(pt.requestStart&&pt.navigationStart&&pt.requestStart<pt.navigationStart||pt.responseStart&&pt.navigationStart&&pt.responseStart<pt.navigationStart||pt.responseStart&&pt.fetchStart&&pt.responseStart<pt.fetchStart||pt.navigationStart&&pt.fetchStart<pt.navigationStart||pt.responseEnd&&pt.responseEnd>BOOMR.now()+864E5){BOOMR.addVar("nt_bad",1);impl.addedVars.push("nt_bad")}try{impl.addedVars.push.apply(impl.addedVars,Object.keys(data))}catch(ignore){}}if(w.chrome&&
w.chrome.loadTimes){pt=w.chrome.loadTimes();if(pt){data={nt_spdy:pt.wasFetchedViaSpdy?1:0,nt_cinf:pt.connectionInfo,nt_first_paint:pt.firstPaintTime};BOOMR.addVar(data);try{impl.addedVars.push.apply(impl.addedVars,Object.keys(data))}catch(ignore$4){}}}impl.sendBeacon()},clear:function(){if(impl.addedVars&&impl.addedVars.length>0){BOOMR.removeVar(impl.addedVars);impl.addedVars=[]}this.complete=false},prerenderToVisible:function(){this.complete=false;this.done()}};BOOMR.plugins.NavigationTiming={init:function(){if(!impl.initialized){BOOMR.subscribe("page_ready",
impl.done,null,impl);BOOMR.subscribe("prerender_to_visible",impl.prerenderToVisible,null,impl);BOOMR.subscribe("xhr_load",impl.xhr_done,null,impl);BOOMR.subscribe("before_unload",impl.done,null,impl);BOOMR.subscribe("onbeacon",impl.clear,null,impl);impl.initialized=true}return this},is_complete:function(){return true}}})();
(function(){var impl;BOOMR=BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(BOOMR.plugins.ResourceTiming)return;var INITIATOR_TYPES={"other":0,"img":1,"link":2,"script":3,"css":4,"xmlhttprequest":5,"html":6,"image":7,"beacon":8,"fetch":9};var DEFAULT_XSS_BREAK_WORDS=[/(h)(ref)/gi,/(s)(rc)/gi,/(a)(ction)/gi];var XSS_BREAK_DELIM="\n";var DEFAULT_URL_LIMIT=500;var SPECIAL_DATA_PREFIX="*";var SPECIAL_DATA_DIMENSION_TYPE="0";var SPECIAL_DATA_SIZE_TYPE="1";var SPECIAL_DATA_SCRIPT_ATTR_TYPE="2";var ASYNC_ATTR=
1;var DEFER_ATTR=2;var LOCAT_ATTR=4;function convertToTrie(entries){var trie={},url,urlFixed,i,value,letters,letter,cur,node;for(url in entries){urlFixed=url;for(i=0;i<impl.xssBreakWords.length;i++)urlFixed=urlFixed.replace(impl.xssBreakWords[i],"$1"+XSS_BREAK_DELIM+"$2");if(!entries.hasOwnProperty(url))continue;value=entries[url];letters=urlFixed.split("");cur=trie;for(i=0;i<letters.length;i++){letter=letters[i];node=cur[letter];if(typeof node==="undefined")cur=cur[letter]=i===letters.length-1?value:
{};else if(typeof node==="string")cur=cur[letter]={"|":node};else if(i===letters.length-1)cur[letter]["|"]=value;else cur=cur[letter]}}return trie}function optimizeTrie(cur,top){var num=0,node,ret,topNode;var keys=[];for(node in cur)if(cur.hasOwnProperty(node))keys.push(node);for(var i=0;i<keys.length;i++){node=keys[i];if(typeof cur[node]==="object"){ret=optimizeTrie(cur[node],false);if(ret){delete cur[node];if(node===XSS_BREAK_DELIM){node=ret.name;num++}else node=node+ret.name;cur[node]=ret.value}}num++}if(num===
1)if(top){topNode={};topNode[node]=cur[node];return topNode}else return{name:node,value:cur[node]};else if(top)return cur;else return false}function trimTiming(time,startTime){if(typeof time!=="number")time=0;if(typeof startTime!=="number")startTime=0;var timeMs=Math.round(time?time:0),startTimeMs=Math.round(startTime?startTime:0);return timeMs===0?0:timeMs-startTimeMs}function isFrameAccessible(frame){var dummy;try{dummy=frame.location&&frame.location.href;dummy=frame.document;if("performance"in
frame&&frame.performance)return true}catch(e){}return false}function getNavStartTime(frame){var navStart=0;if(isFrameAccessible(frame)&&frame.performance.timing&&frame.performance.timing.navigationStart)navStart=frame.performance.timing.navigationStart;return navStart}function findPerformanceEntriesForFrame(frame,isTopWindow,offset,depth,frameDims){var entries=[],i,navEntries,navStart,frameNavStart,frameOffset,subFrames,subFrameDims,navEntry,t,rtEntry,visibleEntries,scripts={},a;if(typeof isTopWindow===
"undefined")isTopWindow=true;if(typeof offset==="undefined")offset=0;if(typeof depth==="undefined")depth=0;if(depth>10)return entries;try{if(!isFrameAccessible(frame))return entries;navStart=getNavStartTime(frame);visibleEntries=getVisibleEntries(frame,frameDims);a=frame.document.createElement("a");Array.prototype.forEach.call(frame.document.getElementsByTagName("script"),function(s){a.href=s.src;if(a.href.match(/^https?:\/\//))scripts[a.href]=s});subFrames=frame.document.getElementsByTagName("iframe");
if(subFrames&&subFrames.length)for(i=0;i<subFrames.length;i++){frameNavStart=getNavStartTime(subFrames[i].contentWindow);frameOffset=0;if(frameNavStart>navStart)frameOffset=offset+(frameNavStart-navStart);a.href=subFrames[i].src;entries=entries.concat(findPerformanceEntriesForFrame(frame.frames[i],false,frameOffset,depth+1,visibleEntries[a.href]))}if(typeof frame.performance.getEntriesByType!=="function")return entries;if(isTopWindow){navEntries=frame.performance.getEntriesByType("navigation");if(navEntries&&
navEntries.length===1){navEntry=navEntries[0];entries.push({name:frame.location.href,startTime:0,initiatorType:"html",redirectStart:navEntry.redirectStart,redirectEnd:navEntry.redirectEnd,fetchStart:navEntry.fetchStart,domainLookupStart:navEntry.domainLookupStart,domainLookupEnd:navEntry.domainLookupEnd,connectStart:navEntry.connectStart,secureConnectionStart:navEntry.secureConnectionStart,connectEnd:navEntry.connectEnd,requestStart:navEntry.requestStart,responseStart:navEntry.responseStart,responseEnd:navEntry.responseEnd,
workerStart:navEntry.workerStart,encodedBodySize:navEntry.encodedBodySize,decodedBodySize:navEntry.decodedBodySize,transferSize:navEntry.transferSize})}else if(frame.performance.timing){t=frame.performance.timing;if(t.navigationStart!==0&&t.responseEnd<=t.navigationStart+60*60*1E3)entries.push({name:frame.location.href,startTime:0,initiatorType:"html",redirectStart:t.redirectStart?t.redirectStart-t.navigationStart:0,redirectEnd:t.redirectEnd?t.redirectEnd-t.navigationStart:0,fetchStart:t.fetchStart?
t.fetchStart-t.navigationStart:0,domainLookupStart:t.domainLookupStart?t.domainLookupStart-t.navigationStart:0,domainLookupEnd:t.domainLookupEnd?t.domainLookupEnd-t.navigationStart:0,connectStart:t.connectStart?t.connectStart-t.navigationStart:0,secureConnectionStart:t.secureConnectionStart?t.secureConnectionStart-t.navigationStart:0,connectEnd:t.connectEnd?t.connectEnd-t.navigationStart:0,requestStart:t.requestStart?t.requestStart-t.navigationStart:0,responseStart:t.responseStart?t.responseStart-
t.navigationStart:0,responseEnd:t.responseEnd?t.responseEnd-t.navigationStart:0})}}var frameEntries=frame.performance.getEntriesByType("resource"),frameFixedEntries=[];for(i=0;frameEntries&&i<frameEntries.length;i++){t=frameEntries[i];rtEntry={name:t.name,initiatorType:t.initiatorType,startTime:t.startTime+offset,redirectStart:t.redirectStart?t.redirectStart+offset:0,redirectEnd:t.redirectEnd?t.redirectEnd+offset:0,fetchStart:t.fetchStart?t.fetchStart+offset:0,domainLookupStart:t.domainLookupStart?
t.domainLookupStart+offset:0,domainLookupEnd:t.domainLookupEnd?t.domainLookupEnd+offset:0,connectStart:t.connectStart?t.connectStart+offset:0,secureConnectionStart:t.secureConnectionStart?t.secureConnectionStart+offset:0,connectEnd:t.connectEnd?t.connectEnd+offset:0,requestStart:t.requestStart?t.requestStart+offset:0,responseStart:t.responseStart?t.responseStart+offset:0,responseEnd:t.responseEnd?t.responseEnd+offset:0,workerStart:t.workerStart?t.workerStart+offset:0,encodedBodySize:t.encodedBodySize,
decodedBodySize:t.decodedBodySize,transferSize:t.transferSize,visibleDimensions:visibleEntries[t.name],latestTime:getResourceLatestTime(t)};if(t.initiatorType==="script"&&scripts[t.name]){var s=scripts[t.name];rtEntry.scriptAttrs=(s.async?ASYNC_ATTR:0)|(s.defer?DEFER_ATTR:0);while(s.nodeType===1&&s.nodeName!=="BODY")s=s.parentNode;rtEntry.scriptAttrs|=s.nodeName==="BODY"?LOCAT_ATTR:0}frameFixedEntries.push(rtEntry)}entries=entries.concat(frameFixedEntries)}catch(e){return entries}return entries}function toBase36(n){return typeof n===
"number"&&n!==0?n.toString(36):typeof n==="string"?n:""}function getVisibleEntries(win,winDims){var els=["img","iframe","image"],entries={},x,y,doc=win.document,a=doc.createElement("A");winDims=winDims||[0,0,0,0];x=winDims[3]+(win.pageXOffset!==undefined)?win.pageXOffset:(doc.documentElement||doc.body.parentNode||doc.body).scrollLeft;y=winDims[2]+(win.pageYOffset!==undefined)?win.pageYOffset:(doc.documentElement||doc.body.parentNode||doc.body).scrollTop;els.forEach(function(elname){var elements=doc.getElementsByTagName(elname),
el,i,rect,src;for(i=0;i<elements.length;i++){el=elements[i];if(el){src=el.src||el.getAttribute("src")||el.getAttribute("xlink:href");a.href=src;src=a.href;if(src&&!entries[src]){rect=el.getBoundingClientRect();if((rect.height||el.offsetHeight)&&(rect.width||el.offsetWidth)){entries[src]=[rect.height||el.offsetHeight,rect.width||el.offsetWidth,Math.round(rect.top+y),Math.round(rect.left+x)];if((el.naturalHeight||el.naturalWidth)&&(entries[src][0]!==el.naturalHeight||entries[src][1]!==el.naturalWidth))entries[src].push(el.naturalHeight,
el.naturalWidth)}}}}});return entries}function getFilteredResourceTiming(from,to,initiatorTypes){var entries=findPerformanceEntriesForFrame(BOOMR.window,true,0,0),i,e,results={},initiatorType,url,data,navStart=getNavStartTime(BOOMR.window);if(!entries||!entries.length)return[];entries.sort(function(a,b){return a.startTime-b.startTime});var filteredEntries=[];for(i=0;i<entries.length;i++){e=entries[i];if(e.name.indexOf("about:")===0||e.name.indexOf("javascript:")===0||e.name.indexOf("res:")===0)continue;
if(e.name.indexOf(BOOMR.url)>-1||e.name.indexOf(BOOMR.config_url)>-1||typeof BOOMR.getBeaconURL==="function"&&BOOMR.getBeaconURL()&&e.name.indexOf(BOOMR.getBeaconURL())>-1)continue;if(from&&navStart+e.startTime<from)continue;if(to&&navStart+e.startTime>to)break;if(typeof initiatorTypes!=="undefined"&&initiatorTypes!=="*"&&initiatorTypes.length)if(!e.initiatorType||!BOOMR.utils.inArray(e.initiatorType,initiatorTypes))continue;filteredEntries.push(e)}return filteredEntries}function compressSize(resource){var sTrans,
sEnc,sDec,sizes;if(resource.encodedBodySize||resource.decodedBodySize||resource.transferSize){sTrans=resource.transferSize;sEnc=resource.encodedBodySize;sDec=resource.decodedBodySize;sizes=[sEnc,sTrans?sTrans-sEnc:"_",sDec?sDec-sEnc:0];return sizes.map(toBase36).join(",").replace(/,+$/,"")}else return""}function decompressSize(compressed,resource){var split,i;if(typeof resource==="undefined")resource={};split=compressed.split(",");for(i=0;i<split.length;i++)if(split[i]==="_")split[i]=0;else{if(split[i]===
"")split[i]=0;split[i]=parseInt(split[i],36);if(i>0)split[i]+=split[0]}if(split.length===1)split.push(split[0]);if(split.length===2)split.push(split[0]);resource.encodedBodySize=split[0];resource.transferSize=split[1];resource.decodedBodySize=split[2];return resource}function decompressTimePoints(comp){var result={},timePoints,i,split,prevs=[0,0,0];timePoints=comp.split("!");for(i=0;i<timePoints.length;i++){split=timePoints[i].replace(/^~/,"Infinity~").replace("-","~0~").split("~").map(function(v,
j){v=v==="Infinity"?Infinity:parseInt(v,36);if(j===2)v=prevs[1]-v;else v=v+prevs[j];prevs[j]=v;return v});result[split[0]]=[split[1],split[2]||split[1]]}return result}function trimUrl(url,urlsToTrim){var i,urlIdx,trim;if(url&&urlsToTrim)for(i=0;i<urlsToTrim.length;i++){trim=urlsToTrim[i];if(typeof trim==="string"){urlIdx=url.indexOf(trim);if(urlIdx!==-1){url=url.substr(0,urlIdx+trim.length)+"...";break}}else if(trim instanceof RegExp)if(trim.test(url))url=url.replace(trim,"$1")+"..."}return BOOMR.utils.cleanupURL(url,
impl.urlLimit)}function getResourceLatestTime(res){if(res.responseEnd)return res.responseEnd;if(res.responseStart&&res.startTime)return res.responseStart+(res.responseStart-res.startTime)*.2;return Infinity}function mergePixels(currentPixels,dimList,pixelValue){var s=BOOMR.window.screen,h=s.height,w=s.width;return dimList.reduce(function(acc,val){var x_min,x_max,y_min,y_max,x,y;x_min=Math.max(0,val[3]);y_min=Math.max(0,val[2]);x_max=Math.min(val[3]+val[1],w);y_max=Math.min(val[2]+val[0],h);if(x_min>=
x_max||y_min>=y_max)return acc;for(y=y_min;y<y_max;y++){if(!acc[y])acc[y]=[];for(x=x_min;x<x_max;x++)acc[y][x]=pixelValue}return acc},currentPixels||[])}function countPixels(pixels,rangeMin,rangeMax){rangeMin=rangeMin||0;rangeMax=rangeMax||Infinity;return pixels.reduce(function(acc,val){return acc+val.filter(function(v){return rangeMin<=v&&v<=rangeMax}).length},0)}function getOptimizedTimepoints(timePoints){var i,roundedTimePoints={},timeSequence,tPixels,t_prev,t,p_prev,p,f_prev,f,comp,result=[];
timeSequence=Object.keys(timePoints);for(i=0;i<timeSequence.length;i++){t=Math.round(Number(timeSequence[i]));if(typeof roundedTimePoints[t]==="undefined")roundedTimePoints[t]=[];Array.prototype.push.apply(roundedTimePoints[t],timePoints[timeSequence[i]])}timeSequence=Object.keys(roundedTimePoints).map(Number).sort(function(a,b){return a-b});if(timeSequence.length===0)return{};for(i=0;i<timeSequence.length;i++){t=timeSequence[i];tPixels=mergePixels(tPixels,roundedTimePoints[t],t);p=countPixels(tPixels);
timeSequence[i]=[t,p]}t_prev=0;p_prev=0;f_prev=0;for(i=0;i<timeSequence.length;i++){t=timeSequence[i][0];p=timeSequence[i][1];f=countPixels(tPixels,0,t);if(p>p_prev||f>f_prev){comp=(t===Infinity?"":toBase36(Math.round(t-t_prev)))+"~"+toBase36(p-p_prev)+"~"+toBase36(p-f);comp=comp.replace(/~~/,"-").replace(/~$/,"");result.push(comp);t_prev=t;p_prev=p;f_prev=f}}return result.join("!").replace(/!+$/,"")}function getCompressedResourceTiming(from,to){var entries=getFilteredResourceTiming(from,to,impl.trackedResourceTypes),
i,e,results={},initiatorType,url,data,timePoints={};if(!entries||!entries.length)return{};for(i=0;i<entries.length;i++){e=entries[i];initiatorType=INITIATOR_TYPES[e.initiatorType];if(typeof initiatorType==="undefined")initiatorType=0;data=initiatorType+[trimTiming(e.startTime,0),trimTiming(e.responseEnd,e.startTime),trimTiming(e.responseStart,e.startTime),trimTiming(e.requestStart,e.startTime),trimTiming(e.connectEnd,e.startTime),trimTiming(e.secureConnectionStart,e.startTime),trimTiming(e.connectStart,
e.startTime),trimTiming(e.domainLookupEnd,e.startTime),trimTiming(e.domainLookupStart,e.startTime),trimTiming(e.redirectEnd,e.startTime),trimTiming(e.redirectStart,e.startTime)].map(toBase36).join(",").replace(/,+$/,"");var compSize=compressSize(e);if(compSize!=="")data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_SIZE_TYPE+compSize;if(e.hasOwnProperty("scriptAttrs"))data+=SPECIAL_DATA_PREFIX+SPECIAL_DATA_SCRIPT_ATTR_TYPE+e.scriptAttrs;url=trimUrl(e.name,impl.trimUrls);if(results[url]!==undefined)results[url]+=
"|"+data;else if(e.visibleDimensions)results[url]=SPECIAL_DATA_PREFIX+SPECIAL_DATA_DIMENSION_TYPE+e.visibleDimensions.map(Math.round).map(toBase36).join(",").replace(/,+$/,"")+"|"+data;else results[url]=data;if(e.visibleDimensions){if(!timePoints[e.latestTime])timePoints[e.latestTime]=[];timePoints[e.latestTime].push(e.visibleDimensions)}}return{restiming:optimizeTrie(convertToTrie(results),true)}}function reduceFetchStarts(resources){var times=[];if(!resources||!resources.length)return times;for(var i=
0;i<resources.length;i++){var res=resources[i];if(i!==resources.length-1&&res.fetchStart===resources[i+1].fetchStart)continue;times.push({fetchStart:res.fetchStart,responseEnd:res.responseStart||res.responseEnd})}return times}function calculateResourceTimingUnion(resources){var i;if(!resources||!resources.length)return 0;resources.sort(function(a,b){if(a.fetchStart!==b.fetchStart)return a.fetchStart-b.fetchStart;else{var ae=a.responseStart||a.responseEnd;var be=b.responseStart||b.responseEnd;return ae-
be}});var times=reduceFetchStarts(resources);var times2=[];var furthestEnd=0;for(i=0;i<times.length;i++){var res=times[i];if(res.fetchStart<furthestEnd)res.fetchStart=furthestEnd;if(res.fetchStart<res.responseEnd){times2.push(res);furthestEnd=res.responseEnd}}var times3=reduceFetchStarts(times2);var totalTime=0;for(i=0;i<times3.length;i++)totalTime+=times3[i].responseEnd-times3[i].fetchStart;return totalTime}function addResourceTimingToBeacon(from,to){var r;if(typeof JSON==="undefined")return;BOOMR.removeVar("restiming");
r=getCompressedResourceTiming(from,to);if(r){BOOMR.info("Client supports Resource Timing API","restiming");BOOMR.addVar({restiming:JSON.stringify(r.restiming)})}}impl={complete:false,sentNavBeacon:false,initialized:false,supported:false,xhr_load:function(){if(this.complete)return;this.complete=true;BOOMR.sendBeacon()},xssBreakWords:DEFAULT_XSS_BREAK_WORDS,urlLimit:DEFAULT_URL_LIMIT,clearOnBeacon:false,trimUrls:[],trackedResourceTypes:"*",done:function(){if(this.sentNavBeacon)return;addResourceTimingToBeacon();
this.complete=true;this.sentNavBeacon=true;BOOMR.sendBeacon()},onBeacon:function(vars){var p=BOOMR.getPerformance();if(vars.hasOwnProperty("restiming"))BOOMR.removeVar("restiming");if(impl.clearOnBeacon&&p){var clearResourceTimings=p.clearResourceTimings||p.webkitClearResourceTimings;if(clearResourceTimings&&typeof clearResourceTimings==="function")clearResourceTimings.call(p)}},prerenderToVisible:function(){this.sentNavBeacon=false;this.done()}};BOOMR.plugins.ResourceTiming={init:function(config){var p=
BOOMR.getPerformance();BOOMR.utils.pluginConfig(impl,config,"ResourceTiming",["xssBreakWords","clearOnBeacon","urlLimit","trimUrls","trackedResourceTypes"]);if(impl.initialized)return this;if(p&&typeof p.getEntriesByType==="function"){BOOMR.subscribe("page_ready",impl.done,null,impl);BOOMR.subscribe("prerender_to_visible",impl.prerenderToVisible,null,impl);BOOMR.subscribe("xhr_load",impl.xhr_load,null,impl);BOOMR.subscribe("onbeacon",impl.onBeacon,null,impl);BOOMR.subscribe("before_unload",impl.done,
null,impl);impl.supported=true}else impl.complete=true;impl.initialized=true;return this},is_complete:function(){return true},is_supported:function(){return impl.initialized&&impl.supported},getCompressedResourceTiming:getCompressedResourceTiming,getFilteredResourceTiming:getFilteredResourceTiming,calculateResourceTimingUnion:calculateResourceTimingUnion,addResourceTimingToBeacon:addResourceTimingToBeacon,trimTiming:trimTiming,convertToTrie:convertToTrie,optimizeTrie:optimizeTrie,findPerformanceEntriesForFrame:findPerformanceEntriesForFrame,
toBase36:toBase36,getVisibleEntries:getVisibleEntries,reduceFetchStarts:reduceFetchStarts,compressSize:compressSize,decompressSize:decompressSize,trimUrl:trimUrl,getResourceLatestTime:getResourceLatestTime,mergePixels:mergePixels,countPixels:countPixels,getOptimizedTimepoints:getOptimizedTimepoints,decompressTimePoints:decompressTimePoints,SPECIAL_DATA_PREFIX:SPECIAL_DATA_PREFIX,SPECIAL_DATA_DIMENSION_TYPE:SPECIAL_DATA_DIMENSION_TYPE,SPECIAL_DATA_SIZE_TYPE:SPECIAL_DATA_SIZE_TYPE,SPECIAL_DATA_SCRIPT_ATTR_TYPE:SPECIAL_DATA_SCRIPT_ATTR_TYPE,
ASYNC_ATTR:ASYNC_ATTR,DEFER_ATTR:DEFER_ATTR,LOCAT_ATTR:LOCAT_ATTR}})();
(function(){var impl={expires:604800,cookieName:"GUID"};BOOMR.plugins.GUID={init:function(config){var properties=["cookieName","expires"];BOOMR.utils.pluginConfig(impl,config,"GUID",properties);BOOMR.info("Initializing plugin GUID "+impl.cookieName,"GUID");if(!BOOMR.utils.getCookie(impl.cookieName)){BOOMR.info("Could not find a cookie for "+impl.cookieName,"GUID");var guid=BOOMR.utils.generateUUID();if(!BOOMR.utils.setCookie(impl.cookieName,guid,impl.expires))BOOMR.subscribe("before_beacon",function(){BOOMR.utils.setCookie(impl.cookieName,
guid,impl.expires)});BOOMR.info("Setting GUID Cookie value to: "+guid+" expiring in: "+impl.expires+"s","GUID")}else BOOMR.info("Found a cookie named: "+impl.cookieName+" value: "+BOOMR.utils.getCookie(impl.cookieName),"GUID");return this},is_complete:function(){return true}}})(this);
(function(){var connection;if(typeof navigator==="object")connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection||navigator.msConnection;if(!connection)return;BOOMR.addVar({"mob.ct":connection.type,"mob.bw":connection.bandwidth,"mob.mt":connection.metered});if(connection.downlinkMax)BOOMR.addVar("mob.lm",connection.downlinkMax)})();